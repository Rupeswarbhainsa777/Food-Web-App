<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ page import="java.util.*, java.text.DecimalFormat" %>
<%@ page import="com.tap.modeal.Cart" %>
<%@ page import="com.tap.modeal.CartItem" %>

<%
    Cart cart = (Cart) session.getAttribute("cart");
    DecimalFormat df = new DecimalFormat("£#.00");
    double subtotal = 0.0;
    double processingFee = 2.00;
%>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Food Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* [PASTE ALL THE CSS HERE — already provided above] */
  </style>
</head>
<body>

<div class="cart-container">
  <div class="cart-left">
    <h2>Food cart</h2>

    <div class="cart-items">
      <%
        if (cart != null && !cart.getItems().isEmpty()) {
            for (CartItem item : cart.getItems().values()) {
                double itemTotal = item.getPrice() * item.getQuantity();
                subtotal += itemTotal;
      %>
      <div class="item">
        <img src="<%= item.getImageUrl() != null ? item.getImageUrl() : "https://via.placeholder.com/60" %>" alt="item">
        <div class="item-details">
          <h4><%= item.getName() %></h4>
          <small><%= item.getName() %></small>
        </div>
        <div class="quantity">
          <button>-</button>
          <span><%= item.getQuantity() %></span>
          <button>+</button>
        </div>
        <p><%= df.format(item.getPrice()) %></p>
        <button class="remove">×</button>
      </div>
      <%
            }
        } else {
      %>
        <p>No items in cart.</p>
      <% } %>
    </div>
  </div>

  <div class="cart-summary">
    <h3>summary</h3>
    <label>coupon code</label>
    <input type="text" placeholder="0000">
    <a href="#" class="add-voucher">+ add</a>

    <div class="summary-line">
      <span>subtotal</span><span><%= df.format(subtotal) %></span>
    </div>
    <div class="summary-line">
      <span>other processing fee</span><span><%= df.format(processingFee) %></span>
    </div>
    <div class="summary-line">
      <span>est taxes</span><span>—</span>
    </div>
    <div class="summary-line total">
      <span>total</span><span><%= df.format(subtotal + processingFee) %></span>
    </div>

    <div class="summary-line grand-total">
      <span>grand total</span><span><strong><%= df.format(subtotal + processingFee) %></strong></span>
    </div>

    <button class="checkout-btn">proceed to checkout</button>
  </div>
</div>

</body>
</html>

    