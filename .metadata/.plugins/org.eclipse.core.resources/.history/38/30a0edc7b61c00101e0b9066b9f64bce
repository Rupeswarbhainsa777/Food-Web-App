package com.tap.DaoImple;
import com.tap.modeal.User;

import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import com.tap.Dao.UserDao;

public class UserImp implements UserDao
{ 
	
	private Connection con = null;
	private String url = "jdbc:mysql://localhost/foodapp";
	private String username ="root";
    private String password ="@sumit222";
    
	String insertQuery = "INSERT INTO `user` (`userId`,`name`,`email`,`phoneno`,`address`,`username`,`password`,`role`,`currentdate`,`lastlogin`,``) VALUES "+ "(?,?,?,?,?,?,?,?,?,?)";

	String retreiveQuery = "SELECT * FROM `user` WHERE `email` = ?";
	String updateQuery = "UPDATE `user` SET `email` = ?,`address` = ?,`username` = ? , `password` = ? , `role` = ? WHERE `userId` = ?";
	String deleteQuery = "DELETE FROM `user` WHERE `userId` = ?";
	String selectQuery = "Select * FROM `user`";
	
	PreparedStatement pstm = null;
	Statement stm = null;
	ResultSet res= null;
	
	
	public UserImp() 
	{
	try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			
	           con=DriverManager.getConnection(url, username, password);
			 
			
			
		} catch (Exception e)
	{
			e.printStackTrace();
		}
	}
	
	@Override
	public int addUser(User user) 
	{
		
		
		
		
		
		try {
		pstm = con.prepareStatement(insertQuery);
		
		
	       pstm.setString(1, user.getUserName());
			pstm.setString(2, user.getPassword());
			pstm.setString(3, user.getEmail());
			pstm.setString(4, user.getAddress());
		   pstm.setString(5, user.getRole());
		return pstm.executeUpdate();
	} catch (Exception e) {
		e.printStackTrace();
			return 0;
		}

	}

}




//import com.food.DAOs.UserDAO;
//import com.food.model.User;
//
//public class UserImp implements UserDAO {
//	
//	private String url = "jdbc:mysql://localhost:3306/tapfood";
//	private String username = "root";
//	private String password = "aish0305";
//	String insertQuery = "INSERT INTO `user` (`user_name`,`password`,`email`,`address`,`role`) VALUES (?,?,?,?,?)";
//	
//	
//	
//	
//	PreparedStatement ps = null;
//	Statement st = null;
//	ResultSet res = null;
//
//	public UserImp() {
//		try {
//			Class.forName("com.mysql.cj.jdbc.Driver");
//			con = DriverManager.getConnection(url, username, password);
//		} catch (ClassNotFoundException | SQLException e) {
//			e.printStackTrace();
//		}
//	}
//
//	@Override
//	public int addUser(User user) {
//		try {
//			ps = con.prepareStatement(insertQuery);
//			ps.setString(1, user.getUsername());
//			ps.setString(2, user.getPassword());
//			ps.setString(3, user.getEmail());
//			ps.setString(4, user.getAddress());
//			ps.setString(5, user.getRole());
//			return ps.executeUpdate();
//		} catch (SQLException e) {
//			e.printStackTrace();
//			return 0;
//		}
//
//	}
//
//	@Override
//	public User getUser(String email) {
//		User user = null;
//		try {
//			ps = con.prepareStatement(retreiveQuery);
//			ps.setString(1, email);
//			ResultSet res = ps.executeQuery();
//			if (res.next()) {
//				user = extractUserFromResultSet(res);
//			}
//		} catch (SQLException e) {
//
//			e.printStackTrace();
//		}
//		return user;
//	}
//
//	@Override
//	public void deleteUser(int user) {
//		try {
//			ps = con.prepareStatement(deleteQuery);
//			ps.setInt(1, user);
//			ps.executeUpdate();
//		} catch (SQLException e) {
//			e.printStackTrace();
//		}
//
//	}
//
//	@Override
//	public void updateUser(User user) {
//		try {
//			ps = con.prepareStatement(updateQuery);
//			ps.setString(1, user.getUsername());
//			ps.setString(2, user.getPassword());
//			ps.setString(3, user.getEmail());
//			ps.setString(4, user.getAddress());
//			ps.setString(5, user.getRole());
//			ps.setInt(6, user.getId());
//			System.out.println("row affected: " + ps.executeUpdate());
//
//			ps.executeUpdate();
//		} catch (Exception e) {
//			e.printStackTrace();
//		}
//	}
//
//	private User extractUserFromResultSet(ResultSet res) throws SQLException {
//		User user = new User();
//		user.setId(res.getInt("user_id"));
//		user.setUsername(res.getString("user_name"));
//		user.setPassword(res.getString("password"));
//		user.setEmail(res.getString("email"));
//		user.setAddress(res.getString("address"));
//		user.setRole(res.getString("role"));
//		return user;
//	}
//
//	@Override
//	public List<User> getAll() {
//		List<User> al = new ArrayList<>();
//		try {
//			st = con.createStatement();
//			res = st.executeQuery(selectQuery);
//			while (res.next()) {
//				User u = extractUserFromResultSet(res);
//				al.add(u);
//			}
//		} catch (SQLException e) {
//			e.printStackTrace();
//		}
//
//		return null;
//	}
}