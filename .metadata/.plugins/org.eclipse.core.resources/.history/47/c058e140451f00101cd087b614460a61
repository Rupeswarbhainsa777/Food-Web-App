package com.tap.controller;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;

import java.util.List;

import com.tap.DaoImple.MenuImp;
import com.tap.modeal.*;

@WebServlet("/Menu")
public class Menue extends HttpServlet {

	@Override
	protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

	    String resturentIdStr = req.getParameter("resturentId");

	    if (resturentIdStr != null && !resturentIdStr.isEmpty()) {
	        try {
	            int resturentId = Integer.parseInt(resturentIdStr);

	            MenuImp imp = new MenuImp();
	            List<Menu> menuImp = imp.getAllMenuByRestarent(resturentId);

	            req.setAttribute("menu", menuImp);
	            for (Menu m : menuImp) 
	            {
	                System.out.println(m.getItemName());
	            }

	            RequestDispatcher rd = req.getRequestDispatcher("menu.js"); // confirm this is a JSP or not?
	            rd.forward(req, resp);

	        } catch (NumberFormatException e) {
	            System.out.println("Invalid resturentId format: " + resturentIdStr);
	            resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Invalid restaurant ID format.");
	        }

	    } else {
	        System.out.println("Missing parameter: resturentId");
	        resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Missing required parameter 'resturentId'");
	    }
	}


}
