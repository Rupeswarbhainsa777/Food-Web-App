package com.tap.DaoImple;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.tap.modeal.Restaurant;

public class RestaurantImp {
	private Connection con = null;
	private String url = "jdbc:mysql://localhost/foodapp";
	private String username = "root";
	private String password = "@sumit222";

	private PreparedStatement pstmt = null;
	private Statement stmt = null;
	private ResultSet resultSet = null;

	private static final String ADD_RESTAURANT = "insert into `restaurant`(`restaurantName`,`imgagepath`,`rating`,`eta`,`cuisineType`,`address`,`isActive`,`restaurantOwnerId`)"
			+ "values(?,?,?,?,?,?,?,?)";

	private static final String SELECT_ALL_RESTAURANT = "select * from `restaurant`";
	private static final String SELECT_RESTAURANT = "select * from `restaurant` where `restaurant_id`=?";
	private static final String UPDATE_ON_RESTAURANTNAME = "update `restaurant`  set `restaurantName`=?, `imagePath`=?, `rating`=?, `eta`=?, `cuisineType`=?,"
			+ " `address`=?, `isActive`=? ,`restaurantOwnerId`=?  where `restaurant_id`=?";

	private static final String DELETE = "delete from `restaurent` where `restaurant_id`=?";

	public RestaurantImp() {
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			con = DriverManager.getConnection(url, username, password);

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	void addRestaurant(Restaurant res) {
		try {

			pstmt = con.prepareStatement(ADD_RESTAURANT);
			pstmt.setString(1, res.getName());
			pstmt.setString(2, res.getImagepath());
			pstmt.setInt(3, res.getRating());
			pstmt.setString(4, res.getEta());
			pstmt.setString(5, res.getCuisineType());
			pstmt.setString(6, res.getAddress());
			pstmt.setBoolean(7, res.getIsActive());
			pstmt.setString(8, res.getRestaurantOwnerId());

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public Restaurant getSpecificRestaurant(int restaurant_id) {
		Restaurant res = null;

		try {
			pstmt = con.prepareStatement(SELECT_RESTAURANT);
			pstmt.setInt(1, restaurant_id);
			resultSet = pstmt.executeQuery();

			if (resultSet.next()) {
				String name = resultSet.getString("restaurantName");
				String imagepath = resultSet.getString("imgagepath");
				double rating = resultSet.getDouble("rating");
				int eat = resultSet.getInt("eta");
				String cusinetype = resultSet.getString("cuisineType");
				String addres = resultSet.getString("address");
				boolean isActive = resultSet.getBoolean("isActive");
				String restaurantOwnerId = resultSet.getString("restaurantOwnerId");
			}

//				res = new Restaurant(restaurant_id,name,imagepath,rating,eta,cusinetype, addres, isActive,restaurantOwnerId);

		} catch (Exception e) {

			e.printStackTrace();
		}

	}
	
	
	@Override
	 void updateRestaurant(Restaurant rest)
	{
		
		try {
			
			pstmt = con.prepareStatement(UPDATE_ON_RESTAURANTNAME);
			pstmt.setString(1, rest.getName());
			pstmt.setString(2, rest.getImagepath());
			pstmt.setInt(3, rest.getRating());
			pstmt.setString(4, rest.getEta());
			pstmt.setString(5, rest.getCuisineType());
			pstmt.setString(6, rest.getAddress());
			pstmt.setBoolean(7, rest.getIsActive());
			pstmt.setString(8, rest.getRestaurantOwnerId());
			pstmt.setInt(9, rest.getRestaurantId());
			

			
			System.out.println(pstmt.executeUpdate());
			
			
			
		} catch (SQLException e) {
			
			e.printStackTrace();
		}
		
		
	}

}
